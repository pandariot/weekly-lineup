<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>The Lineup — BuzzFeed</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #0A0A0A; color: #FAFAFA;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    min-height: 100vh; -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }
  .m { font-family: 'SFMono-Regular', Menlo, Consolas, monospace; }
  .wrap { display: flex; flex-direction: column; align-items: center; padding: 0 16px; min-height: 100vh; }
  .inner { width: 100%; max-width: 480px; }
  .hdr { text-align: center; padding-top: 40px; margin-bottom: 20px; }
  .hdr small { display: block; font-size: 12px; letter-spacing: 0.2em; color: #666; text-transform: uppercase; margin-bottom: 4px; }
  .hdr h1 { font-size: 32px; font-weight: 800; letter-spacing: -0.02em; }
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script>
var h = React.createElement;

var PZ = [
  { id:"spotify", cat:"SPOTIFY", icon:"\u{1F3A4}", color:"#1DB954",
    prompt:"Most monthly listeners on Spotify right now", dir:"most to fewest monthly listeners",
    items:[{n:"The Weeknd",v:"115.2M",s:5},{n:"Taylor Swift",v:"97.8M",s:4},{n:"Billie Eilish",v:"82.4M",s:3},{n:"Bad Bunny",v:"71.6M",s:2},{n:"Sabrina Carpenter",v:"64.3M",s:1}]},
  { id:"box", cat:"BOX OFFICE", icon:"\u{1F3AC}", color:"#E50914",
    prompt:"Highest grossing this weekend", dir:"highest to lowest gross",
    items:[{n:"Dune: Part Three",v:"$82.4M",s:5},{n:"Captain America: Brave New World",v:"$45.1M",s:4},{n:"Bridget Jones: Mad About the Boy",v:"$22.3M",s:3},{n:"The Monkey",v:"$14.7M",s:2},{n:"Paddington in Peru",v:"$8.9M",s:1}]},
  { id:"google", cat:"MOST GOOGLED", icon:"\u{1F50D}", color:"#4285F4",
    prompt:"Most Googled people this week", dir:"most to fewest searches",
    items:[{n:"Taylor Swift",v:"12.4M",s:5},{n:"Travis Kelce",v:"9.8M",s:4},{n:"Zendaya",v:"7.2M",s:3},{n:"Pete Davidson",v:"5.6M",s:2},{n:"Ice Spice",v:"3.1M",s:1}]},
  { id:"billboard", cat:"BILLBOARD", icon:"\u{1F3B5}", color:"#FF6B35",
    prompt:"Highest on the Hot 100 this week", dir:"highest to lowest chart position",
    items:[{n:"Die With A Smile - Gaga",v:"#1",s:5},{n:"APT. - ROSE & Mars",v:"#3",s:4},{n:"Lovers & Friends - Usher",v:"#5",s:3},{n:"Luther - Kendrick & SZA",v:"#7",s:2},{n:"Timeless - Weeknd & Carti",v:"#9",s:1}]},
  { id:"wiki", cat:"WIKIPEDIA", icon:"\u{1F310}", color:"#636466",
    prompt:"Most viewed on Wikipedia this week", dir:"most to fewest pageviews",
    items:[{n:"Conan O'Brien",v:"4.8M",s:5},{n:"Severance (TV series)",v:"3.2M",s:4},{n:"Super Bowl LX",v:"2.9M",s:3},{n:"Timothee Chalamet",v:"2.1M",s:2},{n:"Bird flu",v:"1.7M",s:1}]}
];

function shuf(a){var b=a.slice();for(var i=b.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=b[i];b[i]=b[j];b[j]=t;}return b;}

function App(){
  var _sc=React.useState("menu"),sc=_sc[0],setSc=_sc[1];
  var _pz=React.useState(null),pz=_pz[0],sPz=_pz[1];
  var _it=React.useState([]),it=_it[0],sIt=_it[1];
  var _at=React.useState(1),at=_at[0],sAt=_at[1];
  var _fb=React.useState(null),fb=_fb[0],sFb=_fb[1];
  var _hi=React.useState([]),hi=_hi[0],sHi=_hi[1];
  var _w=React.useState(false),wi=_w[0],sW=_w[1];
  var _cp=React.useState(false),cp=_cp[0],sCp=_cp[1];
  var _dn=React.useState([]),dn=_dn[0],sDn=_dn[1];
  var _ar=React.useState({}),ar=_ar[0],sAr=_ar[1];
  var _di=React.useState(null),di=_di[0],sDi=_di[1];
  var _dy=React.useState(0),dy=_dy[0],sDy=_dy[1];
  // waiting = show feedback, block submit, allow drag to clear
  var _wt=React.useState(false),wt=_wt[0],sWt=_wt[1];
  var sY=React.useRef(0),rH=React.useRef(72),eR=React.useRef([]);
  var ul=dn.length;

  function go(p){
    sPz(p);sIt(shuf(p.items.map(function(x,i){return{n:x.n,v:x.v,s:x.s,id:"i"+i};})));
    sAt(1);sFb(null);sHi([]);sW(false);sCp(false);sDi(null);sWt(false);setSc("play");
  }

  function sub(){
    var res=it.map(function(x,i){
      var ci=pz.items.findIndex(function(c){return c.n===x.n;});
      var d=Math.abs(i-ci);
      return{n:x.n,v:x.v,s:x.s,id:x.id,diff:d,em:d===0?"\u{1F7E9}":"\u{1F7E5}"};
    });
    var ok=res.every(function(r){return r.diff===0;});
    sFb(res);
    var nh=hi.concat([res.map(function(r){return r.em;})]);
    sHi(nh);

    if(ok){
      sW(true);
      setTimeout(function(){
        var o={};o[pz.id]={win:true,att:nh.length,grid:nh};
        sAr(function(p){return Object.assign({},p,o);});
        sDn(function(p){return p.concat([pz.id]);});
        setSc("result");
      },1400);
    } else if(at>=3){
      // Last attempt failed - show feedback, then reveal correct
      setTimeout(function(){
        sIt(pz.items.map(function(x,i){return{n:x.n,v:x.v,s:x.s,id:"i"+i};}));
        sFb(pz.items.map(function(x){return{n:x.n,v:x.v,diff:0,em:"\u{1F7E9}"};}));
        setTimeout(function(){
          var o={};o[pz.id]={win:false,att:3,grid:nh};
          sAr(function(p){return Object.assign({},p,o);});
          sDn(function(p){return p.concat([pz.id]);});
          setSc("result");
        },1400);
      },1800);
    } else {
      // Not last attempt - show feedback, enter waiting mode
      sAt(at + 1);
      sWt(true);
    }
  }

  function onDn(ev,i){
    if(wi) return;
    ev.preventDefault();
    // If in waiting mode (feedback showing), clear it and go back to active
    if(wt){
      sFb(null);
      sWt(false);
    }
    var el=eR.current[i];
    if(el) rH.current=el.getBoundingClientRect().height+8;
    sDi(i);sY.current=ev.clientY;sDy(0);
  }

  React.useEffect(function(){
    if(di===null) return;
    var ci=di,sy=sY.current;
    function mv(ev){
      ev.preventDefault();
      var d=ev.clientY-sy;sDy(d);
      var th=rH.current*0.5;
      if(d>th&&ci<it.length-1){
        sIt(function(p){var n=p.slice();var t=n[ci];n[ci]=n[ci+1];n[ci+1]=t;return n;});
        ci++;sDi(ci);sy+=rH.current;sY.current=sy;sDy(d-rH.current);
      }else if(d<-th&&ci>0){
        sIt(function(p){var n=p.slice();var t=n[ci];n[ci]=n[ci-1];n[ci-1]=t;return n;});
        ci--;sDi(ci);sy-=rH.current;sY.current=sy;sDy(d+rH.current);
      }
    }
    function up(){sDi(null);sDy(0);}
    document.addEventListener("pointermove",mv,{passive:false});
    document.addEventListener("pointerup",up);
    document.addEventListener("pointercancel",up);
    return function(){
      document.removeEventListener("pointermove",mv);
      document.removeEventListener("pointerup",up);
      document.removeEventListener("pointercancel",up);
    };
  },[di,it.length]);

  function cpy(t){try{navigator.clipboard.writeText(t);}catch(x){}sCp(true);setTimeout(function(){sCp(false);},2000);}

  function hdr(){
    return h("div",{className:"hdr"},
      h("small",{className:"m"},"BuzzFeed Presents"),
      h("h1",null,"THE LINEUP")
    );
  }

  function badge(color,txt){
    return h("span",{style:{display:"inline-flex",alignItems:"center",gap:8,background:color+"20",border:"1px solid "+color+"40",borderRadius:100,padding:"5px 14px",fontFamily:"SFMono-Regular,Menlo,monospace",fontSize:10,letterSpacing:"0.12em",textTransform:"uppercase",color:color}},txt);
  }

  // ══ MENU ══
  if(sc==="menu"){
    var allD=dn.length===PZ.length;
    return h("div",{className:"wrap"},h("div",{className:"inner"},
      hdr(),
      h("p",{style:{color:"#666",fontSize:14,textAlign:"center",marginBottom:16}},
        allD?"All rounds complete!":"Rank 5 items. 3 attempts. 5 rounds."),
      dn.length>0&&!allD&&h("div",{className:"m",style:{fontSize:12,color:"#555",textAlign:"center",marginBottom:16}},"Round "+(dn.length+1)+" of 5"),
      PZ.map(function(p,idx){
        var isDn=dn.indexOf(p.id)>=0,isNx=idx===ul,lk=idx>ul,r=ar[p.id];
        return h("div",{key:p.id,onClick:function(){if(isNx)go(p);},style:{
          background:p.color+"12",border:"1.5px solid "+p.color+(isNx?"60":"20"),
          borderRadius:16,padding:"18px 20px",display:"flex",alignItems:"center",gap:14,
          cursor:isNx?"pointer":"default",opacity:lk?0.35:1,transition:"all 0.2s",marginBottom:10
        }},
          h("div",{style:{fontSize:28,width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:12,background:"rgba(255,255,255,0.06)",flexShrink:0}},p.icon),
          h("div",{style:{flex:1}},
            h("div",{className:"m",style:{fontSize:10,letterSpacing:"0.15em",textTransform:"uppercase",color:"#888",marginBottom:2}},p.cat),
            h("div",{style:{fontSize:14,fontWeight:600,lineHeight:1.3,color:"#E0E0E0"}},p.prompt),
            isDn&&r&&h("div",{style:{display:"flex",gap:3,marginTop:6,alignItems:"center"}},
              r.grid[r.grid.length-1].map(function(em,j){return h("span",{key:j,style:{fontSize:13}},em);}),
              h("span",{className:"m",style:{fontSize:10,color:"#888",marginLeft:6}},r.win?r.att+"/3":"x/3")
            )
          ),
          h("div",{style:{color:isDn?"#22c55e":"#555",fontSize:18,flexShrink:0}},isDn?"\u2713":isNx?"\u2192":"\u{1F512}")
        );
      }),
      allD&&h("div",{style:{textAlign:"center",marginTop:24}},
        h("button",{style:{background:"#CDFF00",color:"#0A0A0A",border:"none",borderRadius:14,padding:"16px 32px",fontSize:15,fontWeight:700,cursor:"pointer"},onClick:function(){
          var l=["THE LINEUP \u{1F3AF}\n"];
          PZ.forEach(function(p){var r=ar[p.id];if(!r)return;l.push(p.icon+" "+p.cat+": "+r.grid[r.grid.length-1].join("")+" "+(r.win?"\u2705 "+r.att+"/3":"\u274C"));});
          l.push("\n"+Object.values(ar).filter(function(r){return r.win;}).length+"/5 rounds solved");
          l.push("\nPlay at buzzfeed.com/the-lineup");
          cpy(l.join("\n"));
        }},cp?"\u2713 Copied!":"\u{1F4CB} Share All Results")
      ),
      h("p",{className:"m",style:{color:"#333",fontSize:11,textAlign:"center",marginTop:32,paddingBottom:40}},"New puzzles every Monday")
    ));
  }

  // ══ RESULT ══
  if(sc==="result"){
    return h("div",{className:"wrap"},h("div",{className:"inner"},
      hdr(),
      h("div",{style:{textAlign:"center"}},
        h("div",{style:{fontSize:56,marginBottom:12}},wi?"\u{1F3AF}":"\u{1F624}"),
        h("div",{style:{fontSize:26,fontWeight:800,marginBottom:8}},wi?"Nailed it in "+hi.length+"!":"Better luck next time"),
        h("div",{style:{marginBottom:20}},badge(pz.color,pz.icon+" "+pz.cat)),
        h("div",{style:{marginBottom:20}},
          hi.map(function(row,i){
            return h("div",{key:i,style:{display:"flex",justifyContent:"center",gap:6,marginBottom:6}},
              row.map(function(em,j){return h("span",{key:j,style:{fontSize:26}},em);}));
          })
        )
      ),
      h("div",{style:{textAlign:"left",marginBottom:20}},
        h("div",{className:"m",style:{fontSize:10,letterSpacing:"0.15em",textTransform:"uppercase",color:"#555",marginBottom:10}},"Correct order \u2014 "+pz.dir),
        pz.items.map(function(x,i){
          return h("div",{key:i,style:{display:"flex",alignItems:"center",gap:10,padding:"10px 0",borderBottom:"1px solid rgba(255,255,255,0.06)"}},
            h("div",{className:"m",style:{fontSize:12,color:"#555",width:24}},"#"+(i+1)),
            h("div",{style:{flex:1,fontSize:14,fontWeight:600}},x.n),
            h("div",{className:"m",style:{fontSize:12,color:pz.color,fontWeight:600}},x.v)
          );
        })
      ),
      h("div",{style:{textAlign:"center",paddingBottom:60}},
        dn.length<PZ.length
          ?h("button",{style:{background:"#FAFAFA",color:"#0A0A0A",border:"none",borderRadius:14,padding:"16px 0",width:"100%",fontSize:15,fontWeight:700,cursor:"pointer",marginBottom:40},onClick:function(){
            var ni=PZ.findIndex(function(p){return p.id===pz.id;})+1;
            if(ni<PZ.length)go(PZ[ni]);else setSc("menu");
          }},"Next round \u2192")
          :h("button",{style:{background:"#CDFF00",color:"#0A0A0A",border:"none",borderRadius:14,padding:"16px 32px",fontSize:15,fontWeight:700,cursor:"pointer",marginBottom:40},onClick:function(){setSc("menu");}},"See all results \u2192")
      )
    ));
  }

  // ══ PLAY ══
  var showSub=!fb&&!wt&&!wi;
  return h("div",{className:"wrap",style:{touchAction:"pan-x"}},h("div",{className:"inner"},
    hdr(),
    badge(pz.color,pz.icon+" "+pz.cat),
    h("div",{style:{fontSize:20,fontWeight:700,lineHeight:1.3,marginTop:8,marginBottom:4}},pz.prompt),
    h("div",{className:"m",style:{fontSize:12,color:"#666",marginBottom:24}},"Drag to rank: "+pz.dir),

    it.map(function(item,i){
      var f=fb?fb[i]:null;
      var act=di===i;
      var gn=f&&f.em==="\u{1F7E9}";
      var rd=f&&f.em==="\u{1F7E5}";
      var bg=act?"rgba(255,255,255,0.12)":gn?"rgba(34,197,94,0.3)":rd?"rgba(239,68,68,0.25)":"rgba(255,255,255,0.04)";
      var bd=act?"rgba(255,255,255,0.35)":gn?"rgba(34,197,94,0.6)":rd?"rgba(239,68,68,0.5)":"rgba(255,255,255,0.08)";

      return h("div",{key:item.id,ref:function(el){eR.current[i]=el;},
        onPointerDown:function(ev){onDn(ev,i);},
        style:{
          background:bg,border:"1.5px solid "+bd,borderRadius:14,padding:"14px 16px",
          display:"flex",alignItems:"center",gap:10,marginBottom:8,
          transition:act?"none":"all 0.2s ease",
          transform:act?"translateY("+dy+"px) scale(1.03)":"scale(1)",
          boxShadow:act?"0 8px 32px rgba(0,0,0,0.5)":"none",
          zIndex:act?10:1,position:"relative",
          userSelect:"none",touchAction:"none",
          cursor:wi?"default":"grab"
        }},
        !f&&h("div",{style:{color:act?"#aaa":"#555",fontSize:20,flexShrink:0,lineHeight:1}},"\u2807"),
        f&&h("div",{style:{fontSize:18,flexShrink:0}},f.em),
        h("div",{className:"m",style:{fontSize:12,color:"#555",width:20,flexShrink:0}},(i+1)+"."),
        h("div",{style:{flex:1,fontSize:15,fontWeight:600,lineHeight:1.3}},item.n),
        f&&f.diff===0&&h("div",{className:"m",style:{fontSize:11,color:pz.color,flexShrink:0}},item.v)
      );
    }),

    // History grid
    hi.length>0&&h("div",{style:{marginTop:12,padding:"12px 0",borderTop:"1px solid rgba(255,255,255,0.06)"}},
      hi.map(function(row,i){
        return h("div",{key:i,style:{display:"flex",alignItems:"center",gap:8,marginBottom:4}},
          h("span",{className:"m",style:{fontSize:10,color:"#444",width:14}},(i+1)+"."),
          h("span",{style:{display:"flex",gap:4}},
            row.map(function(em,j){return h("span",{key:j,style:{fontSize:20}},em);})
          ),
          h("span",{className:"m",style:{fontSize:10,color:"#444",marginLeft:8}},
            row.filter(function(x){return x==="\u{1F7E9}";}).length+"/5")
        );
      })
    ),

    // Attempt bar
    h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:20,marginBottom:12}},
      h("span",{className:"m",style:{fontSize:12,color:"#555"}},"Attempt "+at+"/3"),
      h("span",{style:{display:"flex",gap:8}},
        [0,1,2].map(function(i){return h("div",{key:i,style:{width:10,height:10,borderRadius:"50%",background:i<at?"#fff":"rgba(255,255,255,0.15)"}});})
      )
    ),

    // Submit button or hint
    showSub&&h("button",{style:{background:"#FAFAFA",color:"#0A0A0A",border:"none",borderRadius:14,padding:"16px 0",width:"100%",fontSize:15,fontWeight:700,cursor:"pointer"},onClick:sub},"Lock in my order \u2192"),
    wt&&h("div",{className:"m",style:{textAlign:"center",color:"#888",fontSize:12,padding:"14px 0",background:"rgba(255,255,255,0.03)",borderRadius:10}},
      "\u{1F7E9} = right spot  \u{1F7E5} = wrong spot \u2014 drag to rearrange"),
    h("div",{style:{height:40}})
  ));
}

ReactDOM.render(h(App),document.getElementById("root"));
</script>
</body>
</html>
